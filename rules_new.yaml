# Substore å…¼å®¹ Mihomo / Mihomo Party é…ç½®ï¼ˆrules ç²¾ç®€ç‰ˆï¼‰
# ç›®æ ‡ï¼š
# 1) ä¿æŒå¹¶ä¿®æ­£ DNS é˜²æ³„éœ²ï¼ˆDNS å‡ºå£æŒ‡å‘ ğŸ”° æ¨¡å¼é€‰æ‹©ï¼Œé¿å…åç§°ä¸ä¸€è‡´å¯¼è‡´å¤±æ•ˆï¼‰
# 2) ä¸æ”¹å˜ç°æœ‰åˆ†æµé€»è¾‘å‰æä¸‹ï¼Œé™ä½å†…å­˜å ç”¨ï¼šæœåŠ¡ç±»ç­–ç•¥ç»„ä¸å† include-allï¼ˆé¿å…é‡å¤æŒ‚è½½å…¨éƒ¨èŠ‚ç‚¹ï¼‰
# 3) ğŸ”® Gemini ç»„æ”¹ä¸ºã€ŒğŸ”® Google+Geminiã€ï¼Œå¹¶æ‰¿è½½å…¨éƒ¨ Googleï¼ˆå« Geminiï¼‰åˆ†æµ
# 4) Telegram è¡¥å…… Web ç«¯åŸŸåè§„åˆ™ï¼ˆä»…é  telegramcidr å¯èƒ½æ— æ³•è¦†ç›– web.telegram.orgï¼‰
# 5) ğŸ/â“‚ï¸ æœåŠ¡ç»„ä»…ä¿ç•™é€‰æ‹©å™¨ï¼ˆæ¨¡å¼/èŠ‚ç‚¹/è½åœ°/ç›´è¿ï¼‰
# 6) å»é™¤æ— å®é™…ä½œç”¨çš„ã€ŒâŒ å…¨å±€æ‹¦æˆªã€ï¼Œä»¥åŠã€ŒğŸŸ æ¼ç½‘ä¹‹é±¼ã€å…œåº•ï¼ˆå…œåº•ç›´æ¥èµ° ğŸ”° æ¨¡å¼é€‰æ‹©ï¼‰

dns:
  enable: true
  prefer-h3: false
  listen: "0.0.0.0:1053"
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: "198.18.0.1/16"
  fake-ip-filter:
    - "+.lan"
    - "+.local"
    - "localhost.ptlogin2.qq.com"
    - "+.msftconnecttest.com"
    - "+.msftncsi.com"
    - "+.googleapis.com"
    - "+.googleapis.cn"
    - "alt1-mtalk.google.com"
    - "alt2-mtalk.google.com"
    - "alt3-mtalk.google.com"
    - "alt4-mtalk.google.com"
    - "alt5-mtalk.google.com"
    - "alt6-mtalk.google.com"
    - "alt7-mtalk.google.com"
    - "alt8-mtalk.google.com"
    - "mtalk.google.com"
  use-hosts: true

  # ä»…ç”¨äºå¼•å¯¼è§£æä»£ç†åŸŸåï¼šç›´è¿ä¸”ä¸ç»ä»£ç†
  default-nameserver:
    - "114.114.114.114#DIRECT"
    - "223.5.5.5#DIRECT"
    - "119.29.29.29#DIRECT"
    - "180.76.76.76#DIRECT"
    - "180.184.1.1#DIRECT"

  # ç»™â€œä»£ç†æœåŠ¡å™¨åŸŸåè§£æâ€ç”¨ï¼šç›´è¿ DoHï¼Œé¿å…ä»£ç†å¾ªç¯
  proxy-server-nameserver:
    - "https://dns.alidns.com/dns-query#DIRECT"
    - "https://doh.pub/dns-query#DIRECT"
    - "https://doh.onedns.net/dns-query#DIRECT"

  # ä¸šåŠ¡åŸŸåè§£æï¼šå…¨éƒ¨èµ°ä»£ç†ç»„ï¼ˆé˜²æ³„éœ²ï¼‰
  nameserver:
    - "https://cloudflare-dns.com/dns-query#ğŸ”° æ¨¡å¼é€‰æ‹©"
    - "https://dns.google/dns-query#ğŸ”° æ¨¡å¼é€‰æ‹©"
    - "https://dns.quad9.net/dns-query#ğŸ”° æ¨¡å¼é€‰æ‹©"

  # æŒ‡å®šåŸŸå/é›†åˆçš„è§£æç­–ç•¥ï¼šèƒ½ç›´è¿çš„å°±ç›´è¿ DoHï¼Œæ˜“æ³„éœ²/è·¨åŸŸçš„èµ°ä»£ç† DoH
  nameserver-policy:
    "geosite:cn":
      - "https://dns.alidns.com/dns-query#DIRECT"
      - "https://doh.pub/dns-query#DIRECT"
    "+.msftconnecttest.com,+.msftncsi.com": "https://cloudflare-dns.com/dns-query#ğŸ”° æ¨¡å¼é€‰æ‹©"
    "+.googleapis.com,+.googleapis.cn": "https://cloudflare-dns.com/dns-query#ğŸ”° æ¨¡å¼é€‰æ‹©"

tun:
  enable: true
  stack: gvisor
  auto-route: true
  auto-detect-interface: true
  strict-route: true
  dns-hijack:
    - any:53 # åŠ«æŒæ‰€æœ‰ 53 UDP/TCP
  device: SakuraiTunnel
  mtu: 1500 # 9000 å®¹æ˜“å‡ºé—®é¢˜ï¼›ä¸ç¨³å°±ç”¨ 1500/1480
  endpoint-independent-nat: true

rule-providers:
  reject:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/reject.txt"
    path: "./ruleset/loyalsoldier/reject.yaml"

  customdirect:
    type: http
    format: yaml
    behavior: domain
    interval: 86400
    url: "https://cdn.jsdelivr.net/gh/wangbaoqiang-lixiaolu/substore@main/custom-direct.yaml"
    path: "./ruleset/custom-direct.yaml"

  customproxy:
    type: http
    format: yaml
    behavior: domain
    interval: 86400
    url: "https://fastly.jsdelivr.net/gh/wangbaoqiang-lixiaolu/substore@main/custom-proxy.yaml"
    path: "./ruleset/custom-proxy.yaml"

  icloud:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: "./ruleset/loyalsoldier/icloud.yaml"

  apple:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: "./ruleset/loyalsoldier/apple.yaml"

  google:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
    path: "./ruleset/loyalsoldier/google.yaml"

  proxy:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: "./ruleset/loyalsoldier/proxy.yaml"

  direct:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: "./ruleset/loyalsoldier/direct.yaml"

  private:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: "./ruleset/loyalsoldier/private.yaml"

  tld-not-cn:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: "./ruleset/loyalsoldier/tld-not-cn.yaml"

  gfw:
    type: http
    format: yaml
    interval: 86400
    behavior: domain
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: "./ruleset/loyalsoldier/gfw.yaml"

  telegramcidr:
    type: http
    format: yaml
    interval: 86400
    behavior: ipcidr
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: "./ruleset/loyalsoldier/telegramcidr.yaml"

  cncidr:
    type: http
    format: yaml
    interval: 86400
    behavior: ipcidr
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: "./ruleset/loyalsoldier/cncidr.yaml"

  lancidr:
    type: http
    format: yaml
    interval: 86400
    behavior: ipcidr
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: "./ruleset/loyalsoldier/lancidr.yaml"

  applications:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://fastly.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: "./ruleset/loyalsoldier/applications.yaml"

  openai:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/openai.yaml"
    path: "./ruleset/MetaCubeX/openai.yaml"

  bybit:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/bybit.yaml"
    path: "./ruleset/MetaCubeX/bybit.yaml"

  pikpak:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/pikpak.yaml"
    path: "./ruleset/MetaCubeX/pikpak.yaml"

  anthropic:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/anthropic.yaml"
    path: "./ruleset/MetaCubeX/anthropic.yaml"

  xai:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/xai.yaml"
    path: "./ruleset/MetaCubeX/xai.yaml"

  perplexity:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/perplexity.yaml"
    path: "./ruleset/MetaCubeX/perplexity.yaml"

  microsoft:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/microsoft.yaml"
    path: "./ruleset/MetaCubeX/microsoft.yaml"

  google-gemini:
    type: http
    format: yaml
    interval: 86400
    behavior: classical
    url: "https://raw.githubusercontent.com/MetaCubeX/meta-rules-dat/refs/heads/meta/geo/geosite/classical/google-gemini.yaml"
    path: "./ruleset/MetaCubeX/google-gemini.yaml"

rules:
  # Telegramï¼ˆè¡¥å…… Web ç«¯åŸŸåï¼‰
  - "DOMAIN,web.telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN,webk.telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN,webz.telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN,api.telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN,core.telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,t.me,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,telegram.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,telegram.me,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,telegramcdn.org,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,telesco.pe,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
  - "DOMAIN-SUFFIX,telegra.ph,ğŸ“² ç”µæŠ¥æ¶ˆæ¯"

  # è¿›ç¨‹ä¼˜å…ˆ
  - "PROCESS-NAME,dota2.exe,ğŸ”— å…¨å±€ç›´è¿"
  - "PROCESS-NAME,steam.exe,ğŸ”— å…¨å±€ç›´è¿"

  # è‡ªå®šä¹‰è§„åˆ™ï¼šç›´è¿/ä»£ç†
  - "RULE-SET,customdirect,ğŸ”— å…¨å±€ç›´è¿"
  - "RULE-SET,customproxy,ğŸ”° æ¨¡å¼é€‰æ‹©"

  # Google + Geminiï¼ˆè¡¥å……æ˜“æ¼åŒ¹é…é¡¹ï¼›å¹¶ç»Ÿä¸€äº¤ç»™åŒä¸€ç­–ç•¥ç»„ï¼‰
  - "DOMAIN,gemini.google.com,ğŸ”® Google+Gemini"
  - "DOMAIN,bard.google.com,ğŸ”® Google+Gemini"
  - "DOMAIN-SUFFIX,ai.google.dev,ğŸ”® Google+Gemini"
  - "DOMAIN,makersuite.google.com,ğŸ”® Google+Gemini"
  - "DOMAIN-SUFFIX,gstatic.com,ğŸ”® Google+Gemini"
  - "DOMAIN-SUFFIX,googleapis.cn,ğŸ”® Google+Gemini"
  - "DOMAIN-SUFFIX,xn--ngstr-lra8j.com,ğŸ”® Google+Gemini"

  # å¸¸ç”¨éœ€è¦èµ°ä»£ç†çš„åŸŸå
  - "DOMAIN-SUFFIX,github.io,ğŸ”° æ¨¡å¼é€‰æ‹©"
  - "DOMAIN,v2rayse.com,ğŸ”° æ¨¡å¼é€‰æ‹©"

  # AI åˆ†æµ
  - "RULE-SET,openai,ğŸ’¬ ChatGPT-Claude-XAI-Perplexity"
  - "RULE-SET,anthropic,ğŸ’¬ ChatGPT-Claude-XAI-Perplexity"
  - "RULE-SET,xai,ğŸ’¬ ChatGPT-Claude-XAI-Perplexity"
  - "RULE-SET,perplexity,ğŸ’¬ ChatGPT-Claude-XAI-Perplexity"

  # å…¶å®ƒæœåŠ¡ï¼ˆä¿æŒä¸æ—§ rules.yaml ä¸€è‡´ï¼šç»Ÿä¸€èµ° ğŸ”° æ¨¡å¼é€‰æ‹©ï¼‰
  - "RULE-SET,pikpak,ğŸ”° æ¨¡å¼é€‰æ‹©"
  - "RULE-SET,bybit,ğŸ”° æ¨¡å¼é€‰æ‹©"

  # ç³»ç»Ÿ/ç›´è¿/å¹¿å‘Š
  - "RULE-SET,applications,ğŸ”— å…¨å±€ç›´è¿"
  - "RULE-SET,private,ğŸ”— å…¨å±€ç›´è¿"
  - "RULE-SET,reject,ğŸ¥° å¹¿å‘Šè¿‡æ»¤"

  # æœåŠ¡åˆ†æµ
  - "RULE-SET,microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡"
  - "RULE-SET,icloud,ğŸ è‹¹æœæœåŠ¡"
  - "RULE-SET,apple,ğŸ è‹¹æœæœåŠ¡"
  - "RULE-SET,google,ğŸ”® Google+Gemini"
  - "RULE-SET,google-gemini,ğŸ”® Google+Gemini"

  # å¸¸è§„å‡ºå›½æµé‡ï¼ˆä¿æŒåŸæœ‰é¡ºåºï¼‰
  - "RULE-SET,proxy,ğŸ”° æ¨¡å¼é€‰æ‹©"
  - "RULE-SET,gfw,ğŸ”° æ¨¡å¼é€‰æ‹©"
  - "RULE-SET,tld-not-cn,ğŸ”° æ¨¡å¼é€‰æ‹©"

  # ç›´è¿ä¼˜å…ˆ
  - "RULE-SET,direct,ğŸ”— å…¨å±€ç›´è¿"
  - "RULE-SET,lancidr,ğŸ”— å…¨å±€ç›´è¿,no-resolve"
  - "RULE-SET,cncidr,ğŸ”— å…¨å±€ç›´è¿,no-resolve"
  - "RULE-SET,telegramcidr,ğŸ“² ç”µæŠ¥æ¶ˆæ¯,no-resolve"
  - "GEOIP,LAN,ğŸ”— å…¨å±€ç›´è¿,no-resolve"
  - "GEOIP,CN,ğŸ”— å…¨å±€ç›´è¿,no-resolve"

  # å…œåº•ï¼šæœªå‘½ä¸­è§„åˆ™é»˜è®¤èµ°ä»£ç†ï¼ˆğŸ”° æ¨¡å¼é€‰æ‹©ï¼‰
  - "MATCH,ğŸ”° æ¨¡å¼é€‰æ‹©"

proxy-groups:
  - name: "ğŸ”° æ¨¡å¼é€‰æ‹©"
    type: select
    proxies:
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"

  # ä¸­ç»§/å‰ç½®é€‰æ‹©ï¼šä¸åŒ…å«â€œè½åœ°/å®¶å®½â€ç±»èŠ‚ç‚¹
  - name: "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - "â™»ï¸ å»¶è¿Ÿé€‰ä¼˜"
    include-all: true
    exclude-filter: "(?i)è½åœ°|å®¶å®½"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/adjust.svg"

  # è½åœ°/å®¶å®½ï¼šç»„çº§é“¾å¼åˆ°â€œâš™ï¸ èŠ‚ç‚¹é€‰æ‹©â€
  - name: "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
    type: select
    include-all: true
    filter: "(?i)è½åœ°|å®¶å®½"
    dialer-proxy: "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/openwrt.svg"

  # è½»é‡è‡ªåŠ¨ä¼˜é€‰ï¼šä¸å«è½åœ°/å®¶å®½
  - name: "â™»ï¸ å»¶è¿Ÿé€‰ä¼˜"
    type: url-test
    tolerance: 50
    include-all: true
    exclude-filter: "(?i)è½åœ°|å®¶å®½"
    interval: 3600
    timeout: 3000
    url: "https://www.google.com/generate_204"
    lazy: true
    max-failed-times: 3
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/speed.svg"

  - name: "ğŸ’¬ ChatGPT-Claude-XAI-Perplexity"
    type: select
    proxies:
      - "ğŸ”° æ¨¡å¼é€‰æ‹©"
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"
      - "â™»ï¸ å»¶è¿Ÿé€‰ä¼˜"
    include-all: true
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/chatgpt.svg"

  - name: "ğŸ”® Google+Gemini"
    type: select
    proxies:
      - "ğŸ”° æ¨¡å¼é€‰æ‹©"
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"
      - "â™»ï¸ å»¶è¿Ÿé€‰ä¼˜"
    include-all: true
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/google.svg"

  - name: "ğŸ“² ç”µæŠ¥æ¶ˆæ¯"
    type: select
    proxies:
      - "ğŸ”° æ¨¡å¼é€‰æ‹©"
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"
      - "â™»ï¸ å»¶è¿Ÿé€‰ä¼˜"
    include-all: true
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/telegram.svg"

  - name: "ğŸ è‹¹æœæœåŠ¡"
    type: select
    proxies:
      - "ğŸ”° æ¨¡å¼é€‰æ‹©"
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/apple.svg"

  - name: "â“‚ï¸ å¾®è½¯æœåŠ¡"
    type: select
    proxies:
      - "ğŸ”° æ¨¡å¼é€‰æ‹©"
      - "âš™ï¸ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ•Šï¸ è½åœ°èŠ‚ç‚¹"
      - "ğŸ”— å…¨å±€ç›´è¿"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/microsoft.svg"

  - name: "ğŸ¥° å¹¿å‘Šè¿‡æ»¤"
    type: select
    proxies:
      - "REJECT"
      - "DIRECT"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/bug.svg"

  - name: "ğŸ”— å…¨å±€ç›´è¿"
    type: select
    proxies:
      - "DIRECT"
    icon: "https://fastly.jsdelivr.net/gh/clash-verge-rev/clash-verge-rev.github.io/main/docs/assets/icons/link.svg"

global-ua: "clash-verge/v2.2.0"
